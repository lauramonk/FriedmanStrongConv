\chapter{Spectral theory of regular graphs}

In this chapter, we introduce the definitions related to regular graphs and their spectrum.
We refer the reader to \cite{chung1992} for a more detailed introduction and motivations.

As in \mathlibok{Graph}, a \emph{graph} is a pair $G = (V, E)$ where $V$ is a set of vertices, and
$E$ a set of edges, and each edge links two unordered, possibly identical vertices.
The notations $V(G)$ and $E(G)$ respectively denote the subsets of $V$ and $E$ corresponding to
vertices or edges of $G$.

Note that this definition allows for loops (i.e. edges going from one vertex to itself) and
multi-edges (i.e. multiple edges connecting two vertices). This convention is essential to the proof
we are aiming for, which is why we use \mathlibok{Graph} instead of the more developed
\mathlibok{SimpleGraph}.

Following \mathlibok{Inc}, we say an edge $e$ is \emph{incident} to a vertex $x$ if there exists a
vertex $y$ such that $e$ links $x$ and $y$. As \mathlibok{IsLoopAt}, an edge is a \emph{loop} based
at a vertex $x$ if it links the vertex $x$ to itself.

\section{Basic notions of graph theory}

Let $G$ be a graph.
Let us define a few basic notions from graph theory.
We make definitions with minimal
hypotheses as these are fundamental objects that should be added to Mathlib.

\subsection{General definitions}

\begin{definition}
\label{def:empty}
We say $G$ is empty if $V(G) = \emptyset$.
\end{definition}

\begin{definition}
  \label{def:bipartite}
  The graph $G$ is \emph{bipartite} if there exists a partition $U_1$,
  $U_2$ of $V(G)$ such that, for all $e \in E(G)$, $e$ links an element of $U_1$
  and an element of $U_2$.
\end{definition}

We will be interested in the Hilbert space $\ell^2(G) := \ell^2(V(G))$, which is defined as the set of
functions $f : V(G) \rightarrow \C$ which are square-summable, equipped with the inner product
$$\langle f, g \rangle = \sum_{x \in V(G)} f(x) \overline{g(x)}.$$

The space $\B(\ell^2(G))$ of bounded linear operators on $\ell^2(G)$ is a unital $\C^*$-algebra.
Note that, in this context, $0$ is the constant function equal to $0$.

\subsection{Walks}

We define a notion of walk on the graph.

\begin{definition}
  \label{def:walk}
  Let $x, y \in V(G)$. A \emph{walk} from $x$ to $y$ on $G$ is given by:
  \begin{itemize}
    \item a non-negative integer $m$;
    \item a family $(v_i)_{0 \leq i \leq m}$ of vertices in $V(G)$;
    \item a family $(e_i)_{1 \leq i \leq m}$ of edges in $E(G)$;
  \end{itemize}
  satisfying the following:
    \begin{itemize}
      \item $v_0=x$ and $v_m=y$;
      \item for any $i \in \{1, \ldots, m\}$, $e_i$ links $v_{i-1}$ and $v_i$.
    \end{itemize}
  The integer $m$ is the \emph{length} of the walk.
\end{definition}

\begin{definition}
  \label{def:connected_rel}
  \uses{def:walk}
  We define a binary relation on $V(G)$ by: $x \sim y$ if there exists a walk
  from $x$ to $y$ on $G$. We then say $x$ and $y$ are \emph{connected}.
\end{definition}

The following three lemmas together prove this is an equivalence relation.

\begin{proposition}
  \label{prop:connected_rel_is_equivalence}
  \uses{lem:connected_rel_reflexive,lem:connected_rel_symmetric,
  lem:connected_rel_transitive}
  $\sim$ is an equivalence relation.
\end{proposition}

\begin{lemma}
  \label{lem:connected_rel_reflexive}
  \uses{def:connected_rel}
  $\sim$ is reflexive: $x \sim x$ for any $x \in V(G)$.
\end{lemma}

\begin{proof}
  Let $x \in V(G)$. We take $m=0$ and set $v_0=x$. Then this is a walk from
  $x$ to $x$ on $G$.
\end{proof}

\begin{lemma}
  \label{lem:connected_rel_symmetric}
  \uses{def:connected_rel}
  $\sim$ is symmetric: if $x \sim y$ then  $y \sim x$.
\end{lemma}

\begin{proof}
  Let $x$, $y$ be two vertices. We assume $x \sim y$. Let $(v_i)_{0 \leq i \leq m}$ and $(e_i)_{1 \leq i \leq m}$
  be a walk from $x$ to $y$. Then $(v_{m-i})_{0 \leq i \leq m}$ and $(e_{m+1-i})_{1 \leq i \leq m}$
  is a walk from $y$ to $x$ by the \mathlibok{is\_link\_symm}. So $y \sim x$.
\end{proof}

\begin{lemma}
    \label{lem:connected_rel_transitive}
  \uses{def:connected_rel}
  $\sim$ is transitive: if $x \sim y$ and $y \sim z$ then
  $x \sim z$.
\end{lemma}

\begin{proof}
  Assume $x \sim y$ and $y \sim z$. Let $(v_i)_{0 \leq i \leq m}$ and $(e_i)_{1 \leq i \leq m}$
  be a walk from $x$ to $y$ and $(v_i')_{0 \leq i \leq m'}$, $(e_i')_{1 \leq i \leq m'}$
  be a walk from $y$ to $z$.
  We let $m''=m+m'$ and define for $i \in \{0, \ldots, m'\}$
  \begin{equation}
    v_i'' := \begin{cases}
      v_i & \text{if } i \leq m \\
      v_{i-m-1}' & \text{otherwise}
    \end{cases}
  \end{equation}
 and for $i \in \{1, \ldots, m'\}$
   \begin{equation}
    e_i'' := \begin{cases}
      e_i & \text{if } i \leq m \\
      e_{i-m}' & \text{otherwise}.
    \end{cases}
  \end{equation}
  Then this is a walk from $x$ to $z$, hence $x \sim z$.
\end{proof}

The following will be useful.

\begin{lemma}
  \label{lem:adjacent_eq}
  \uses{def:connected_rel}
  Let $x$, $y$ in $V(G)$. If $x$ is adjacent to $y$ then $x \sim y$.
\end{lemma}

\begin{proof}
  By definition of adjacency, there exists an edge $e \in E(G)$ linking $x$ and $y$.
  Then the walk $(x, y)$ and $(e)$ is a walk from $x$ to $y$.
\end{proof}

\subsection{Connected components}

We define the connected components of a graph.

\begin{definition}
  \label{def:connected}
    \uses{def:walk}
  A subset $U$ of $V(G)$ is \emph{connected} if,
  for all $x$, $y \in U$, there exists a walk from $x$ to $y$ in $G$.
\end{definition}

\begin{definition}
  \label{def:disconnected}
  \uses{def:connected}
  A subset of $V(G)$ is \emph{disconnected} if it is not connected.
\end{definition}

% Let us list some simple monotony properties.

% \begin{lemma}
%   \label{lem:connected_is_decreasing}
%   \uses{def:connected}
%   Let $U_1$, $U_2$ be two subsets of $V(G)$ such that $U_1 \subseteq U_2$.
%   If $U_2$ is connected, then $U_1$ is connected.
% \end{lemma}

% \begin{proof}
%   Assume $U_2$ is connected. Then, for all $x, y \in U_2$, there exists a walk
%   from $x$ to $y$ in $G$. Since $U_1 \subseteq U_2$, this implies that for all
%   $x$ and $y$ in $U_1$, there exists a walk from $x$ to $y$ in $G$, and hence
%   $U_1$ is connected.
% \end{proof}

\begin{definition}
  \label{def:connected_component}
  \uses{def:connected,def:disconnected}
  A \emph{connected component} of $G$ is a non-empty subset $U$ of $V(G)$
  that is connected and maximal for inclusion, i.e. any subset $U'$ of
  $V(G)$ containing $U$ is disconnected.
\end{definition}

The following observation will allow to prove a few automatic properties directly.

\begin{lemma}
  \label{lem:cc_equivalence_class}
  \uses{def:connected_component,prop:connected_rel_is_equivalence}
  The connected components of $G$ are exactly the equivalence classes of $\sim$.
\end{lemma}

Here are several immediate consequences.

\begin{proposition}
  \label{prop:cc_partition}
  \uses{lem:cc_equivalence_class}
  The connected components of $G$ form a partition of $V(G)$ into non-empty sets.
\end{proposition}

\begin{proof}
  This follows from Lemma \ref{lem:cc_equivalence_class}
  and properties of equivalence classes.
\end{proof}

\begin{definition}
  \label{def:number_cc}
  \uses{def:connected_component}
  The \emph{number of connected components} of a graph is the number of its
  connected components, as an element of $\N \cup \{ \infty\}$.
\end{definition}

We have the following upper bound.

\begin{lemma}
  \label{lem:bound_number_cc}
  \uses{prop:cc_partition}
  If $V(G)$ is finite, then its number of connected components is finite and at most $\# V(G)$.
\end{lemma}

\begin{proof}
  This follows from Proposition \ref{prop:cc_partition}
  and the fact that the number of elements in a partition of a finite set is at most its cardinal.
\end{proof}

\begin{proposition}
  \label{prop:cc_of_a_vertex}
  \uses{lem:cc_equivalence_class}
  Let $x \in V(G)$. Then the set of $y \in V(G)$ such that there exists a
  walk from $x$ to $y$ is the unique connected component of $G$ containing $x$.
\end{proposition}

\begin{proof}
  This follows from Lemma \ref{lem:cc_equivalence_class}
  and properties of equivalence classes.
\end{proof}

\begin{lemma}
  \label{lem:adjacent_same_cc}
  \uses{lem:cc_equivalence_class,lem:adjacent_eq}
  For $x$, $y$ in $V(G)$, if $x$ is adjacent to $y$, then they belong to the same
  connected component.
\end{lemma}

\begin{proof}
  This follows from Lemma \ref{lem:cc_equivalence_class} together with Lemma
  \ref{lem:adjacent_eq}.
\end{proof}

\subsection{Notions of finiteness}

\begin{definition}
  \label{def:locally_finite_at}
  Let $x$ be a vertex of $G$.
  We say $G$ is \emph{locally finite at $x$} if $\incset (x)$ is finite.
\end{definition}

\begin{definition}
  \label{def:locally_finite}
  \uses{def:locally_finite_at}
  $G$ is said to be \emph{locally finite} if, for all $x \in V(G)$, $G$ is locally finite at $x$.
\end{definition}

\begin{definition}
  \label{def:finite}
  We say $G$ is \emph{finite} if $V(G)$ and $E(G)$ are both finite.
\end{definition}

% \begin{proposition}
%   \label{def:finite_vs_locally_finite}
%   \uses{def:finite,def:locally_finite}
%   $G$ is finite if and only if $V(G)$ is finite and $G$ is locally finite.
% \end{proposition}

\subsection{Degree and regularity}

\begin{definition}
  \label{def:degree}
  \uses{def:locally_finite_at}
  Let $x$ be a vertex of $G$. We assume $G$ is locally finite at $x$.
  The \emph{degree} of $x$ is the number of incident edges, counting loops twice:
  \begin{equation*}
    \mathrm{deg}(x) = \sum_{e \in \incset(x)}
    2^{\isloop(e)}.
  \end{equation*}
\end{definition}

\begin{definition}
  \label{def:regular}
  \uses{def:locally_finite, def:degree}
  Let $d$ be a non-negative integer.
  We say $G$ is \emph{regular of degree $d$} if it is not empty, locally finite and,
  for every $x \in V(G)$, $\deg (x) = d$.
\end{definition}

\begin{definition}
  \label{def:locally_bounded}
  \uses{def:degree,def:locally_finite}
  We say $G$ is \emph{locally bounded} if
  it is locally finite and there exists a constant $D$ such that,
  for all $x \in V(G)$, $\deg(x) \leq D$.
\end{definition}

\subsection{Constant fonctions}

\begin{definition}
  \label{def:constant_function}
  The constant function equal to $1$ is defined by
  \begin{equation}
    \const :
    \begin{cases}
      V(G) & \rightarrow \C \\
      x & \mapsto 1.
    \end{cases}
  \end{equation}
\end{definition}

\begin{lemma}
  \label{lem:constant_neq_zero}
  \uses{def:empty,def:constant_function}
  Assume $G$ is not empty. Then the constant function $\const$ is not equal to $0$.
\end{lemma}

\begin{proof}
  If $G$ is not empty, then by Definition \ref{def:empty}, there exists $x \in V(G)$.
  Then $\const (x) = 1 \neq 0$, and hence $\const$ is not equal to the constant function $0$.
\end{proof}

\begin{lemma}
  \label{lem:constant_is_l2}
  \uses{def:constant_function}
  The constant function $\const$ belongs in $\ell^2(G)$
  if and only if $V(G)$ is finite.
\end{lemma}

\begin{proof}
  This is simply the fact that
  the constant sequence is summable if and only if the set is finite.
\end{proof}

\begin{definition}
  \label{def:locally_constant}
  A function $f : V(G) \rightarrow \C$ is said to be \emph{locally constant}
  if, for all $x,y \in V(G)$, if $x$ is adjacent to $y$, then $f(x)=f(y)$.
\end{definition}

\begin{lemma}
  \label{lem:locally_constant_walk}
  \uses{def:connected_rel,def:locally_constant}
  Let $f : V(G) \rightarrow \C$ be a locally constant function.
  For any $x, y \in V(G)$, if $x \sim y$, then $f(x)=f(y)$.
\end{lemma}

\begin{proof}
  Let $x, y \in V(G)$ such that $x \sim y$.
  By Definition \ref{def:connected_rel}, there exists a walk $(v_i)_{0 \leq i \leq m}$,
  $(e_i)_{1 \leq i \leq m}$ from $x$ to $y$.
  Let $i \in \{1, \ldots, m\}$. The edge $e_i$ links $v_{i-1}$ to $v_i$
  and hence $v_{i-1}$ is adjacent to $v_i$. By Definition \ref{def:locally_constant},
  $f(v_{i-1})=f(v_i)$. As this is true for all $i \in \{1, \ldots, m\}$,
  by transitivity of equality (and perhaps a tiny induction?),
  $f(v_0)=f(v_m)$, i.e. $f(x)=f(y)$ since $v_0=x$ and $v_m=y$.
\end{proof}

\begin{lemma}
  \label{lem:locally_constant_cc}
  \uses{lem:locally_constant_walk,prop:cc_of_a_vertex}
  Let $f : V(G) \rightarrow \C$.
  The function $f$ is locally constant if and only if,
  for any connected component $U$ of $G$,
  for all $x,y \in U, f(x)=f(y)$.
\end{lemma}

\begin{proof}
  Assume $f$ is locally constant.
  Let $U$ be a connected component of $G$. Let $x,y \in U$.
  By Proposition \ref{prop:cc_of_a_vertex}, $y \sim x$.
  By Lemma \ref{lem:locally_constant_cc}, $f(y)=f(x)$.

  Assume that for any connected component $U$ of $G$,
  for all $x,y \in U, f(x)=f(y)$.
  Let $x$ and $y$ be adjacent elements of $V(G)$.
  By Lemma \ref{lem:adjacent_same_cc}, $x$ and $y$ belong to the same connected component
  $U$. By the assumption, $f(x)=f(y)$. So $f$ is locally constant.
\end{proof}

\section{Adjacency operator}

Let $G$ be a graph.

\subsection{Definition of the adjacency operator and action on constants}

Assume $G$ is locally finite.

\begin{definition}
  \label{def:adjacency_operator}
  \uses{def:locally_finite}
  We define the adjacency operator $a$ as the linear operator acting on the space of
  functions $f : V(G) \rightarrow \C$ by
  $$ a f (x) :=
  \sum_{e \in \incset(x)}
  2^{\isloop(e)} f(\incother(e,x)).$$
\end{definition}

\begin{lemma}
  \label{lem:adjacency_of_constant}
  \uses{def:constant_function,def:adjacency_operator}
  For any $x \in V(G)$, $a \const(x) = \deg(x)$.
\end{lemma}

\begin{proof}
  Let $x \in V(G)$. We have
  \begin{align*}
    a \const(x)
    & = \sum_{e \in \incset(x)}
    2^{\isloop(e)}\const(\incother(e,x))
    & \text{by Definition \ref{def:adjacency_operator}} \\
    & = \sum_{e \in \incset(x)}
    2^{\isloop(e)}
    & \text{by Definition \ref{def:constant_function}} \\
    & = \deg(x)
    & \text{by Definition \ref{def:degree}}.
  \end{align*}
\end{proof}

\subsection{Norm of the adjacency operator}

Let $G$ be a locally finite graph.
The aim of this subsection is to prove the following.

\begin{proposition}
  \label{prop:norm_adjacency_leq_sup_degree}
  \uses{lem:bound_a_sup_degree}
  Assume $G$ is locally bounded.
  Then the adjacency operator is a bounded operator on $\ell^2(G)$ and
  its norm satisfies $\|a\| \leq \sup_{x \in V(G)} \deg(x)$.
\end{proposition}

Here is a key lemma.

\begin{lemma}
  \label{lem:bound_a_degree_x}
  \uses{def:adjacency_operator,def:degree}
  For any function $f : V(G) \rightarrow \C$, any vertex $x \in V(G)$,
  \begin{equation}
    |af(x)|^2
    \leq \deg(x)
    \sum_{e \in \incset(x)} 2^{\isloop(e)} |f(\incother(e,x))|^2.
  \end{equation}
  Furthermore, this is an equality if and only if there exists $c \in \C$ such that
  \begin{equation}
    \forall e \in \incset(x), f(\incother(e,x)) = c.
  \end{equation}
\end{lemma}

\begin{proof}
  Let $f : V(G) \rightarrow \C$ and $x \in V(G)$.
  By Definition \ref{def:adjacency_operator},
  \begin{equation}
    |af(x)|^2
    = \left| \sum_{e \in \incset(x)} 2^{\isloop(e)} f(\incother(e, x))\right|^2.
  \end{equation}
  By the \mathlibok{Cauchy-Schwarz} inequality applied to the complex vectors
  \begin{equation}
    v_1 := (2^{\isloop(e)/2})_{e \in \incset(x)}
  \end{equation}
  and
  \begin{equation}
    v_2 := (2^{\isloop(e)/2} f(\incother(e,x)))_{e \in \incset(x)}
  \end{equation}
  we have
  \begin{align*}
    |af(x)|^2
    & = \left| v_1 \cdot v_2 \right|^2
    \leq \|v_1\|_2^2 \|v_2\|_2^2 \\
    &\leq
    \left(\sum_{e \in \incset(x)} 2^{\isloop(e)}
    \right)
    \left( \sum_{e \in \incset(x)} 2^{\isloop(e)} |f(\incother(e, x))|^2
    \right).
  \end{align*}
  This leads to the inequality by Definition \ref{def:degree}.
  The equality case comes from the equality case in Cauchy-Schwarz, which occurs if
  and only if the vectors $v_1$ and $v_2$
  are colinear, which
  is equivalent to the announced condition as $v_1$ is a non-zero constant vector.
\end{proof}

Then Proposition \ref{prop:norm_adjacency_leq_sup_degree} is a trivial consequence of the
following lemma, together with the definition of bounded operator and operator norm.

\begin{lemma}
  \label{lem:bound_a_sup_degree}
  \uses{lem:bound_a_degree_x,def:locally_bounded}
  Assume $G$ is locally bounded. Then, for any $f \in \ell^2(G)$,
  $a f \in \ell^2(G)$ and
  \begin{equation}
    \|a f\| \leq \sup_{x \in V(G)} \deg(x) \times \|f\|.
  \end{equation}
  Furthermore, the equality occurs if and only if $G$ is regular
  and, for any $x \in V(G)$, there exists $c \in \C$ such that
    \begin{equation}
    \forall e \in \incset(x), f(\incother(e,x)) = c.
  \end{equation}
\end{lemma}

\begin{proof}
  To write, basically we need to sum Lemma \ref{lem:bound_a_degree_x} for $x \in V(G)$
  (find the correct summation result), change the order of summation (same)
  and observe that
  \begin{align*}
    \sum_{x \in V(G)}
    \sum_{e \in \incset(x)}
    2^{\isloop(e)}
    |f(\incother(e,x))|^2
    & = \sum_{x \in V(G)} \deg(x) |f(x)|^2 \\
    & \leq \sup_{x \in V(G)} \deg(x) \times \|f\|^2.
  \end{align*}
  If the equality occurs, since all terms are non-negative, it means that
  $\deg (x)$ is constant (i.e. the graph is regular), and that there is equality in
  each term of  Lemma \ref{lem:bound_a_degree_x}, which is the conclusion.
\end{proof}

\subsection{Adjacency operator is self-adjoint}

Let $G$ be a locally bounded graph.

\begin{proposition}
  \label{prop:adjacency_is_selfadjoint}
  \uses{lem:scalar_of_adjacency}
  The adjacency operator is selfadjoint.
\end{proposition}

The following lemma will be very handy.

\begin{lemma}
  \label{lem:scalar_of_adjacency}
  \uses{lem:bound_a_sup_degree}
  For any $f$, $g$ in $\ell^2(G)$,
  \begin{equation}
    \langle af, g \rangle
    = \sum_{\substack{e \in E(G)\\ e \text{ links } x,y}}
    (f(x) \overline{g(y)} + f(y) \overline{g(x)}).
  \end{equation}
\end{lemma}

\begin{proof}
  Let $f$, $g$ be elements of $\ell^2(G)$.
  By Proposition \ref{lem:bound_a_sup_degree}, $a f \in \ell^2(G)$.
  By definition of the scalar product,
  \begin{equation}
    \langle af, g \rangle
    = \sum_{x \in V(G)} af(x) \overline{g(x)}.
  \end{equation}
  By Definition \ref{def:adjacency_operator},
  \begin{equation}
    \langle af, g \rangle
    = \sum_{x \in V(G)} \sum_{e \in \incset(x)} 2^{\isloop(e)}
    f(\incother(e,x)) \overline{g(x)}
  \end{equation}
  (todo: justify the change of order of summation, notably using Lemma
  \ref{lem:bound_a_sup_degree} to have absolute convergence)
  which we can reorder to the result.
\end{proof}

We are now ready to prove Proposition \ref{prop:adjacency_is_selfadjoint}.

\begin{proof}
  Let $f$, $g$ be elements of $\ell^2(G)$.
  We have by Lemma \ref{lem:scalar_of_adjacency}
  \begin{equation*}
    \langle af, g \rangle
    = \sum_{\substack{e \in E(G)\\ e \text{ links } x,y}}
    (f(x) \overline{g(y)} + f(y) \overline{g(x)})
    = \overline{\sum_{\substack{e \in E(G)\\ e \text{ links } x,y}}
    (g(x) \overline{f(y)} + g(y) \overline{f(x)})}
  \end{equation*}
  by complex conjugation, commutativity of addition and \mathlibok{isLink\_symm}.
  Hence by Lemma \ref{lem:scalar_of_adjacency}
  \begin{equation*}
    \langle af, g \rangle
    = \overline{\langle ag, f \rangle} = \langle f, ag \rangle
  \end{equation*}
  by \mathlibok{inner\_conj\_symm}. This means that $a^*=a$ by definition of
  the adjoint, which means $a$ is self-adjoint by definition.
\end{proof}

\begin{corollary}
  \label{cor:spectrum_is_real}
  \uses{prop:adjacency_is_selfadjoint}
  The spectrum of the adjacency matrix is real.
\end{corollary}

\begin{proof}
  This follows from Proposition \ref{prop:adjacency_is_selfadjoint} with
  \mathlibok{selfAdjoint.mem\_spectrum\_eq\_re}.
\end{proof}

\begin{lemma}
  \label{lem:spectrum_in_segment}
  \uses{cor:spectrum_is_real,prop:norm_adjacency_leq_sup_degree}
  The spectrum of $a$ is included in the
  segment $[-D,D]$ where $D = \sup_{x \in V(G)} \deg(x)$.
\end{lemma}

\begin{proof}
  By Corollary \ref{cor:spectrum_is_real}, the spectrum of $a$ is real.
  By \mathlibok{spectrum.subset\_closedBall\_norm},
  it is included in the closed ball of center $0$ and
  radius $\|a\|$.
  We have $\|a\| \leq \sup_{x \in V(G)} \deg(x)$ by Proposition
   \ref{prop:norm_adjacency_leq_sup_degree}.
\end{proof}

\subsection{The case of regular graphs}

Let $d$ be a non-negative integer.

\begin{lemma}
  \label{lem:adjacency_of_constant_regular}
  \uses{lem:adjacency_of_constant,def:regular}
  Assume $G$ is not empty and locally finite. Then
  $G$ is regular of degree $d$ iff $a \const = d \const$.
\end{lemma}

\begin{proof}
  By Definition \ref{def:regular},
  $G$ is regular of degree $d$ if and only if for all $x \in V(G)$, $\deg(x)=d$.
  By Lemma \ref{lem:adjacency_of_constant}, this is equivalent to
  having, for all $x \in V(G)$, $a \const (x) = d$, which is equivalent to
  $a \const = d \const$ by Definition \ref{def:constant_function}.
\end{proof}

\begin{lemma}
  \label{lem:norm_adjacency_regular_leq_degree}
  \uses{lem:bound_a_sup_degree}
  If $G$ is regular of degree $d$, then $\| a \| \leq d$.
\end{lemma}

\begin{proof}
  This is simply Proposition \ref{prop:norm_adjacency_leq_sup_degree}.
\end{proof}

\begin{lemma}
  \label{lem:spectrum_regular_in_segment}
  \uses{lem:spectrum_in_segment}
  If $G$ is regular of degree $d$, then the spectrum of $a$ is included in the
  segment $[-d,d]$.
\end{lemma}

\begin{proof}
  This is simply Lemma \ref{lem:spectrum_in_segment}.
\end{proof}

\subsection{The case of finite graphs}

\begin{theorem}
  \label{thm:spectral_finite}
  \uses{prop:adjacency_is_selfadjoint}
  Assume $G$ is finite and let $n$ denote the cardinal of $V(G)$.
  Then the spectrum of the adjacency operator is a family of $n$ real eigenvalues
  $$\lambda_1 \geq \lambda_2 \geq \ldots \geq \lambda_n.$$
\end{theorem}

\begin{proof}
  This is the spectral theorem in finite dimension.
\end{proof}

\subsection{The case of finite regular graphs}

Let $d$ be a non-negative integer.

\begin{lemma}
  \label{lem:constant_eigenfunction_regular}
  \uses{lem:constant_is_l2,lem:constant_neq_zero,lem:adjacency_of_constant_regular}
  Assume $G$ is regular of degree $d$ and finite. Then
  $d$ is an eigenvalue of the adjacency
  operator with associated eigenfunction the constant function $\const$.
\end{lemma}

\begin{proof}
  Since $G$ is finite, $\const \in \ell^2(G)$ by Lemma \ref{lem:constant_is_l2}.
  Furthermore, $\const \neq 0$ by Lemma \ref{lem:constant_neq_zero}
  and since $G$ is not empty by Definition \ref{def:regular}.
  By Lemma \ref{lem:adjacency_of_constant_regular}, if $G$ is regular of degree $d$,
  then $a \const = d \const$.  We conclude by the definition of eigenvalue and eigenvector.
\end{proof}

\begin{proposition}
  \label{prop:norm_adjacency_regular}
  \uses{lem:norm_adjacency_regular_leq_degree,lem:constant_eigenfunction_regular}
  If $G$ is finite and regular of degree $d$, then $\|a\|=d$.
\end{proposition}

\begin{proof}
  Since $G$ is regular of degree $d$, by
  Lemma \ref{lem:norm_adjacency_regular_leq_degree}, $\|a \| \leq d$.
  By Lemma \ref{lem:constant_eigenfunction_regular}, $d$ is an eigenvalue of $a$ and hence $\|a\| \geq d$,
  which is enough to conclude.
\end{proof}

\begin{proposition}
  \label{prop:regular_multiplicity_trivial_eigenvalue}
  \uses{def:number_cc,thm:spectral_finite}
  Assume $G$ is finite and regular of degree $d$. Then the multiplicity of the
  eigenvalue $d$ is exactly the number of connected components of $G$.
\end{proposition}

\begin{proof}
  todo
\end{proof}

\begin{proposition}
  \label{prop:eigenvalue_regular_bipartite}
  \uses{def:bipartite}
  Assume $G$ is finite and regular of degree $d$. Then
  $-d$ is an eigenvalue of $a$ if and only if $G$ is bipartite.
\end{proposition}

\begin{proof}
  Assume $G$ is bipartite. By Definition \ref{def:bipartite}, there exists a partition
  $U_1$, $U_2$ of $V(G)$ such that any edge of $G$ links a vertex of $U_1$ and a
  vertex of $U_2$.
  We define a function $f : V(G) \mapsto \C$ by
  \begin{equation}
    f(x) :=
    \begin{cases}
        1 & \text{if } x \in U_1 \\
        -1 & \text{otherwise}.
      \end{cases}
  \end{equation}

\end{proof}
